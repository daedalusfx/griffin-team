<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مستندات جامع - Griffin Guard</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <header>
        <nav>
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L3 5V11C3 16.55 6.84 21.74 12 23C17.16 21.74 21 16.55 21 11V5L12 2ZM12 4.03L19 6.22V11C19 15.5 15.82 19.58 12 20.93C8.18 19.58 5 15.5 5 11V6.22L12 4.03Z" fill="currentColor"/></svg>
                <span>Griffin Guard</span>
            </div>
            <ul class="nav-links">
                <li><a href="index.html">صفحه اصلی</a></li>
                <li><a href="guide.html">راهنمای کاربر</a></li>
                <li><a href="technical.html">مستندات فنی</a></li>
            </ul>
            <a href="#" class="nav-button">دریافت از گیت‌هاب</a>
            <div class="hamburger">
                <div></div>
                <div></div>
                <div></div>
            </div>
        </nav>
    </header>

    <main class="page-main">
        <div class="page-title">
            <h1>مستندات جامع Griffin Guard</h1>
            <p>مرجع کامل تمام قابلیت‌ها، منطق‌ها و توانایی‌های اکسپرت.</p>
        </div>

        <div class="content-wrapper">
            <aside class="sidebar">
                <ul>
                    <li><a href="#philosophy">فلسفه و هدف اصلی</a></li>
                    <li><a href="#prerequisites">پیش‌نیازها</a></li>
                    <li><a href="#ui-components">بخش ۱: رابط کاربری</a></li>
                    <li><a href="#risk-management">بخش ۲: مدیریت ریسک</a></li>
                    <li><a href="#prop-guardian">بخش ۳: محافظ پراپ فرم</a></li>
                    <li><a href="#state-management">بخش ۴: مدیریت وضعیت</a></li>
                </ul>
            </aside>
            <article class="page-content">
                <section id="philosophy">
                    <h2>فلسفه و هدف اصلی</h2>
                    <p><strong>Griffin Guard</strong> صرفاً یک ابزار محاسبه ریسک نیست؛ بلکه یک <strong>دستیار معامله‌گری هوشمند و نگهبان حساب شماست</strong>. این اکسپرت با دو هدف اصلی طراحی شده است:</p>
                    <ul>
                        <li><strong>کاهش خطای انسانی:</strong> خودکارسازی محاسبات پیچیده، اعتبارسنجی لحظه‌ای تصمیمات و جلوگیری از اشتباهات رایج.</li>
                        <li><strong>افزایش سرعت و تمرکز:</strong> فراهم کردن یک رابط کاربری سریع، روان و کارآمد تا معامله‌گر بتواند تمام تمرکز خود را به تحلیل بازار معطوف کند، به‌جای آنکه درگیر تنظیمات ابزار شود.</li>
                    </ul>
                    <p>این پروژه به‌صورت کاملاً متن‌باز (Open Source) تحت مجوز GPLv3 توسعه داده شده تا شفافیت کامل را تضمین کرده و به جامعه معامله‌گران اجازه دهد در توسعه و بهبود آن مشارکت کنند.</p>
                </section>
                
                <section id="prerequisites">
                    <h2>پیش‌نیازها</h2>
                    <ul>
                        <li>پلتفرم معاملاتی MetaTrader 5</li>
                        <li>سیستم عامل ویندوز، مک یا لینوکس (با استفاده از Wine)</li>
                    </ul>
                </section>

                <section id="ui-components">
                    <h2>بخش ۱: رابط کاربری (UI) و اجزای اصلی</h2>
                    <p>گریفین گارد از سه پنل گرافیکی مجزا برای ارائه اطلاعات و دریافت دستورات استفاده می‌کند.</p>
                    
                    <h3 id="panel-dialog">۱.۱. پنل اصلی معاملات (PanelDialog)</h3>
                    <p>این پنل، مرکز اصلی کنترل و مدیریت معاملات شماست و به سه بخش منطقی تقسیم شده است:</p>
                    
                    <h4>الف) بخش Market Execution</h4>
                    <ul>
                        <li><strong>منطق:</strong> برای ورود آنی به معامله با قیمت فعلی بازار.</li>
                        <li><strong>عملکرد:</strong>
                            <ol>
                                <li>با کلیک روی دکمه <strong>Buy</strong> یا <strong>Sell</strong>، خطوط حد ضرر (قرمز) و حد سود (سبز) روی چارت ظاهر می‌شوند. خط ورود روی قیمت فعلی بازار قفل می‌شود.</li>
                                <li>کاربر خطوط حد ضرر (SL) و حد سود (TP) را به محل مورد نظر خود منتقل (Drag) می‌کند.</li>
                                <li>اکسپرت به‌صورت لحظه‌ای حجم لات را بر اساس ریسک وارد شده و فاصله استاپ‌لاس محاسبه می‌کند.</li>
                                <li>یک برچسب وضعیت به کاربر بازخورد می‌دهد (مثلاً "Ready"، "Invalid SL Position" یا "Lot Size Too Small").</li>
                                <li>تنها در صورتی که تمام شرایط معتبر باشند، دکمه <strong>Execute</strong> فعال شده و معامله را ارسال می‌کند.</li>
                            </ol>
                        </li>
                    </ul>

                    <h4>ب) بخش Pending Order</h4>
                     <ul>
                        <li><strong>منطق:</strong> برای ثبت سفارشات شرطی (Stop/Limit).</li>
                        <li><strong>عملکرد:</strong>
                            <ol>
                                <li>با کلیک روی <strong>Buy</strong> یا <strong>Sell</strong>، سه خط ورود (سفید)، حد ضرر و حد سود ظاهر می‌شوند.</li>
                                <li>کاربر هر سه خط را به قیمت‌های دلخواه خود منتقل می‌کند.</li>
                                <li><strong>منطق هوشمند تشخیص نوع سفارش:</strong> اکسپرت به‌صورت خودکار نوع سفارش (Buy Stop, Buy Limit, Sell Stop, Sell Limit) را بر اساس موقعیت خط ورود نسبت به قیمت فعلی بازار تشخیص می‌دهد.</li>
                                <li>پس از اعتبارسنجی کامل، دکمه <strong>Place</strong> سفارش را ثبت می‌کند.</li>
                            </ol>
                        </li>
                    </ul>

                    <h4>ج) بخش Stairway Entry (ورود پلکانی)</h4>
                    <ul>
                        <li><strong>منطق:</strong> یک استراتژی منحصربه‌فرد برای ورود به معامله در پولبک (Pullback) پس از شکست یک سطح کلیدی. این استراتژی ریسک را کاهش داده و نقطه ورود بهینه‌تری فراهم می‌کند.</li>
                        <li><strong>عملکرد:</strong>
                             <ol>
                                <li>با کلیک روی <strong>Arm Buy/Sell</strong>، دو خط اصلی روی چارت ظاهر می‌شود: خط شکست (Breakout - نارنجی) و خط ورود به پولبک (Pending Entry - سفید).</li>
                                <li>کاربر خط شکست را روی سطح مقاومت/حمایت و خط ورود را در محلی که انتظار پولبک دارد، تنظیم می‌کند.</li>
                                <li>اکسپرت بازار را تحت نظر می‌گیرد. به محض اینکه قیمت از خط شکست عبور کند، یک سفارش لیمیت به‌صورت خودکار روی خط ورود به پولبک قرار می‌دهد.</li>
                                <li>این فرآیند به معامله‌گر اجازه می‌دهد تا بدون نیاز به حضور پای چارت، در بهترین قیمت ممکن پس از تأیید شکست، وارد معامله شود.</li>
                            </ol>
                        </li>
                    </ul>

                    <h3 id="display-canvas">۱.۲. پنل نمایش اطلاعات (DisplayCanvas)</h3>
                    <p>این پنل یک داشبورد کامل و زنده از وضعیت حساب و معامله در حال تنظیم شماست.</p>
                    <ul>
                        <li><strong>بخش Setup:</strong> نمایش ریسک به ارز پایه حساب، حجم لات محاسبه‌شده و سود احتمالی (Reward).</li>
                        <li><strong>بخش Details:</strong> نمایش قیمت دقیق خطوط ورود، حد ضرر و حد سود.</li>
                        <li><strong>بخش Live:</strong> اگر معامله‌ای باز داشته باشید، سود/ضرر لحظه‌ای (P/L)، مجموع ریسک تمام معاملات باز و نسبت ریسک به بازده زنده (Live R:R) را نمایش می‌دهد.</li>
                        <li><strong>بخش Prop Firm Guardian:</strong> دو نوار پیشرفت که وضعیت شما را نسبت به محدودیت‌های ضرر روزانه و کلی نمایش می‌دهند.</li>
                    </ul>

                    <h3 id="spread-atr">۱.۳. پنل تحلیل اسپرد و ATR (SpreadAtrAnalysis)</h3>
                    <ul>
                        <li><strong>منطق:</strong> این پنل کوچک به‌عنوان یک راهنمای سریع، اسپرد فعلی را با نوسان متوسط بازار (ATR) مقایسه می‌کند.</li>
                        <li><strong>کاربرد:</strong> به معامله‌گر کمک می‌کند تا تشخیص دهد آیا اسپرد فعلی برای انجام معامله مناسب است یا به دلیل ریسک بالا، بهتر است از معامله صرف نظر کند.</li>
                    </ul>
                </section>

                <section id="risk-management">
                    <h2>بخش ۲: موتور مدیریت ریسک و اعتبارسنجی</h2>
                    <p>این بخش، هسته مرکزی و موتور محاسباتی گریفین گارد است و از تصمیمات شما محافظت می‌کند.</p>
                    
                    <h3 id="lot-calculation">۲.۱. محاسبه دقیق حجم لات (CalculateLotSize)</h3>
                    <ul>
                        <li><strong>دو حالت محاسبه:</strong> کاربر می‌تواند در تنظیمات ورودی، مبنای محاسبه ریسک را بین درصدی از موجودی حساب (RISK_PERCENT) یا مبلغ ثابت (RISK_MONEY) انتخاب کند.</li>
                        <li><strong>دکمه‌های ریسک سریع:</strong> سه دکمه با مقادیر از پیش‌تعیین‌شده (قابل تنظیم در ورودی‌ها) به کاربر اجازه می‌دهد با یک کلیک، ریسک مورد نظر خود را انتخاب کند.</li>
                        <li><strong>اعتبارسنجی حجم:</strong> حجم محاسبه‌شده همیشه با حداقل و حداکثر حجم مجاز بروکر (SYMBOL_VOLUME_MIN, SYMBOL_VOLUME_MAX) مقایسه شده و در صورت نیاز رُند می‌شود. اگر حجم نهایی کمتر از حداقل مجاز باشد، معامله نامعتبر تلقی می‌شود.</li>
                    </ul>

                    <h3 id="realtime-validation">۲.۲. اعتبارسنجی لحظه‌ای (ValidateTradeLogicAndUpdateUI)</h3>
                    <ul>
                        <li><strong>منطق:</strong> این تابع با هر حرکت ماوس یا تغییر در ورودی‌ها فراخوانی می‌شود و تمام شرایط لازم برای یک معامله سالم را بررسی می‌کند:
                            <ul>
                                <li>آیا خطوط حد ضرر و ورود در جای مناسبی قرار دارند؟ (مثلاً برای خرید، SL باید پایین‌تر از Entry باشد).</li>
                                <li>آیا با توجه به فاصله SL، حجم لات قابل محاسبه و معتبر است؟</li>
                            </ul>
                        </li>
                        <li><strong>بازخورد آنی:</strong> نتیجه این اعتبارسنجی فوراً روی برچسب وضعیت پنل نمایش داده شده و دکمه "Execute/Place" را فعال یا غیرفعال می‌کند.</li>
                    </ul>
                </section>

                <section id="prop-guardian">
                    <h2>بخش ۳: محافظ پراپ فرم (Prop Firm Guardian)</h2>
                    <p>این ماژول برای معامله‌گرانی طراحی شده که در چالش‌های شرکت‌های پراپ تریدینگ شرکت می‌کنند.</p>
                    <ul>
                        <li><strong>منطق:</strong> قبل از ارسال هر معامله، تابع `IsTradeRequestSafe` یک شبیه‌سازی از بدترین سناریوی ممکن را اجرا می‌کند. این تابع فرض می‌کند که تمام معاملات باز شما به همراه معامله جدیدی که قصد باز کردن آن را دارید، همزمان به حد ضرر خود می‌رسند.</li>
                        <li><strong>محاسبه ضرر بالقوه:</strong> مجموع ضرر این سناریو محاسبه شده و با دو حد مجاز مقایسه می‌شود:
                            <ol>
                                <li><strong>حد ضرر روزانه (Daily Drawdown):</strong> بر اساس موجودی حساب (Balance) یا موجودی شناور (Equity) در شروع روز معاملاتی.</li>
                                <li><strong>حد ضرر کلی (Max Drawdown):</strong> بر اساس موجودی اولیه حساب (Static) یا بالاترین اکوئیتی ثبت‌شده (Trailing).</li>
                            </ol>
                        </li>
                        <li><strong>عملکرد:</strong> اگر ضرر بالقوه از هر یک از این حدود فراتر رود، اکسپرت به‌صورت خودکار جلوی ارسال معامله را گرفته و دلیل آن را به کاربر اطلاع می‌دهد.</li>
                    </ul>
                </section>

                <section id="state-management">
                    <h2>بخش ۴: مدیریت وضعیت پایدار (StateManager)</h2>
                    <ul>
                        <li><strong>منطق:</strong> برای جلوگیری از دست رفتن اطلاعات در زمان ری‌استارت متاتریدر، این ماژول وضعیت‌های حساس را در یک فایل باینری (`.dat`) ذخیره می‌کند.</li>
                        <li><strong>کاربرد اصلی:</strong> این قابلیت برای استراتژی **Stairway** حیاتی است. اگر در میانه اجرای این استراتژی (مثلاً پس از شکست قیمت و قبل از فعال شدن سفارش لیمیت) متاتریدر بسته شود، پس از اجرای مجدد، اکسپرت تمام اطلاعات (قیمت خطوط، وضعیت فعلی و ...) را بازیابی کرده و به کار خود ادامه می‌دهد، گویی هیچ اتفاقی نیفتاده است.</li>
                    </ul>
                </section>
            </article>
        </div>
    </main>

    <footer>
        <p>ساخته شده با ❤️ برای جامعه متن‌باز. © 2025 Griffin Guard Project</p>
    </footer>

    <script src="script.js"></script>
</body>
</html>
